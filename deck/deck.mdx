import { Image, Notes, Split}  from 'mdx-deck'
import { highlight } from 'mdx-deck/themes'
import Layout from './layout'
import Theme from './theme'

import apolloQuery from './images/apolloQuery.png'
import createFile from './images/createFile.png'
import createNode from './images/createNode.png'
import createResolvers from './images/createResolvers.png'
import gatsbyQuery from './images/gatsbyQuery.png'
import graphcms from './images/graphcms.png'
import graphcmsModel from './images/graphcmsModel.png'
import json from './images/json.png'
import me from './images/memoji.png'
import me2 from './images/memoji2.png'
import printful from './images/printful.png'
import stitchedQuery from './images/stitchedQuery.png'
import useCart from './images/useCart.png'

export const themes = [Theme, highlight]

<Layout>

  # Modular service based commerce

  For the JAMstack

</Layout>

---

<Image src="https://www.azamara.co.uk/sites/default/files/heros/newcastle-upon-tyne-england-1800x1000.jpg" />

---

<Layout>

  <img src={me} style={{ width: '50%' }}/>

</Layout>

---

<Layout>

  <img src={graphcms} style={{ width: '60%' }}/>

</Layout>

---

<Layout>

  # Building commerce sites in 2020

</Layout>

<Notes>

  ‚Ä¢ A new an exciting way to build commerce websites
  ‚Ä¢ Utilising superior developer tooling
  ‚Ä¢ Combining ancillary services and APIs for 

</Notes>

---

<Layout>

  # Dawn of the headless CMS
  
</Layout>

<Notes>

  ‚Ä¢ Separation of concerns
  ‚Ä¢ Content is created and managed independently to our application detail
  ‚Ä¢ This data can then be queried and implemented across a range of application and services as required
  ‚Ä¢ Satisfied both content creators and developers - no longer do we need to make trade offs

</Notes>

---

<Layout>

  # We can build sites differently now, too

  Significant improvements to developer tooling

</Layout>

---

<Layout>

  * Serverless by default
  * CDNs - global, secure and fast
  * React and JavaScript tooling üíØ
  * Content mesh around our app ties services, APIs together

</Layout>

<Notes>

  ‚Ä¢ JAMstack approach abstracts away the maintenance, upkeep of serverless
  ‚Ä¢ Our applications are securely available across the globe
  ‚Ä¢ JavaScript (React) tooling now best in class
  ‚Ä¢ Event driven integrations and GraphQL makes bringing services together easy

</Notes>

---

<Layout>

  # JAMstack ‚ù§Ô∏è commerce

  JAMcommerce

</Layout>


<Notes>

  ‚Ä¢ JAMstack is a great fit for ecommerce websites

</Notes>

---

<Layout>

  * Static product pages
  * Secondary data fetched dynamically
  * Cart logic managed with application state
  * Checkout flow powered by third-party APIs, serverless functions

</Layout>

<Notes>

  ‚Ä¢ 

</Notes>

---

<Layout>

  # You don't need a commerce *platform*

</Layout>

<Notes>

  ‚Ä¢ Utilise best-of-breed services
  ‚Ä¢ No 'jack of all trades' approach
  ‚Ä¢ Best of all, this approach allows you to incrementally transition away from existing systems

</Notes>

---

<Layout>

 <img src={printful} />

</Layout>

<Notes>

  ‚Ä¢ Popular drop shipping service
  ‚Ä¢ Used recently on personal project
  ‚Ä¢ Offers REST API

</Notes>

---

<Layout>

  <img src={json} />

</Layout>

<Notes>

  ‚Ä¢ Printful API is pretty basic
  ‚Ä¢ Available fields relate to the product generated in Printful
  ‚Ä¢ But lacking common meta fields (description, slug, SKU)
  ‚Ä¢ No scope to extend the model either

</Notes>

---

<Layout>

  # Filling the gaps

  Bringing other services to the party üéâ

</Layout>

<Notes>

  ‚Ä¢ We can implement additional APIs or services to enhance our product offering
  ‚Ä¢ Fulfilling the best-of-breed service approach

</Notes>

---

<Image src="https://www.welsermoest.com/wp-content/uploads/2018/12/CLO092918_1886-1295x863.jpg" />

---

<Layout>

  # Orchestrating the content mesh

  With GraphQL and Gatsby

</Layout>

<Notes>

  ‚Ä¢ Gatsby is a compiler for React
  ‚Ä¢ GraphQL at the core
  ‚Ä¢ Amazing developer experience
  ‚Ä¢ NOT only for static sites, can be used to build dynamic experiences too
  ‚Ä¢ Perfect tool to use when building commerce websites
  ‚Ä¢ Powerful APIs allow us to source content and build custom GraphQL schema

</Notes>

---

<Layout>

  <img src={createNode} style={{ width: '45%'}} />

</Layout>

<Notes>

  ‚Ä¢ Two options when using GraphQL in Gatsby: native GraphQL APIs, source plugins
  ‚Ä¢ Extensive APIs for sourcing data in Gatsby
  ‚Ä¢ Here we're creating Gatsby nodes with our product data from the Printful REST API
  ‚Ä¢ These nodes can then be queried via GraphQL in our React components for Gatsby

</Notes>

---

<Layout>

  <img src={createFile} style={{ width: '75%'}} />

</Layout>

<Notes>

  ‚Ä¢ We can also download and create nodes for remote images using `createRemoteFileNode`
  ‚Ä¢ This allows us to use `gatsby-image` to load product images progressively

</Notes>

---

<Layout>

  <img src={gatsbyQuery} style={{ width: '35%'}} />

</Layout>

<Notes>

  ‚Ä¢ This query is from the schema automatically generated for us by the Gatsby source plugin
  ‚Ä¢ We can query nodes that are fetched from third-party sources during build using GraphQL queries
  ‚Ä¢ This data can then be rendered statically in our React components

</Notes>

---

<Layout>

  <Image src="https://files-4iwls3rr4.now.sh/fast.gif" />

</Layout>

---

<Layout>

  # Extending our product schema

  Using GraphCMS

</Layout>

<Notes>

  ‚Ä¢ Utilising a native GraphQL CMS to extend our Printful product model
  ‚Ä¢ Here we can add models and fields missing from Printful that we require to build out our storefront

</Notes>

---

<Layout>

  <img src={graphcmsModel} style={{width: '80%'}}/>

</Layout>

<Notes>

  ‚Ä¢ We've created a new model in our GraphCMS project
  ‚Ä¢ `printfulProductId` field ties our GraphCMS content directly to the associated Printful product
  ‚Ä¢ This relationship is unfortunately 

</Notes>

---

<Layout>

  <img src={createResolvers} style={{ width: '75%'}} />

</Layout>

<Notes>

  ‚Ä¢ Utilising the `createResolvers` API to simulate schema stitching

</Notes>

---

<Layout>

  <img src={stitchedQuery} style={{ width: '35%'}} />

</Layout>

---

<Layout>

  # Dynamic product data

  Fetching data on page load with Apollo Client

</Layout>

<Notes>

  ‚Ä¢ Gatsby runs data queries at build time, resulting in static page builds
  ‚Ä¢ We can utilise other GraphQL clients, such as Apollo, to fetch non-static data during page load
  ‚Ä¢ Inventory, product reviews are examples of this

</Notes>

---

<Layout>

  <img src={apolloQuery} style={{ width: '35%' }}/>

</Layout>

<Notes>

  ‚Ä¢ Sideloading data dynamically like this ensure we get the most recent records
  ‚Ä¢ Prevents blocking rendering of essential page
  ‚Ä¢ Maintains perception of page speed

</Notes>

---

<Layout>

  # Handling cart functionality üõí

  Using local application state to manage carts with `use-react-cart`

</Layout>

<Notes>

  ‚Ä¢ Speedy cart functionality to add, update and remove items
  ‚Ä¢ Restricted to local application state (not session based)
  ‚Ä¢ Alternative APIs are available, including CartQL

</Notes>

---

<Layout>

  <img src={useCart} style={{ width: '35%' }}/>

</Layout>

<Notes>

  ‚Ä¢ Sideloading data dynamically like this ensure we get the most recent records
  ‚Ä¢ Prevents blocking rendering of essential page
  ‚Ä¢ Maintains perception of page speed

</Notes>

---

<Layout>

  <Image src="https://files-7tyseanky.now.sh/fast.gif" />

</Layout>

---

<Layout>

  # It doesn't end there

  Integrate additional third-party services for payments, fulfilment

</Layout>

<Notes>

  ‚Ä¢ Complete the full commerce checkout flow utilising payment APIs such as Stripe of Adyen
  ‚Ä¢ In this particular instance we'd capture payment and then fulfil the order with Printful
  ‚Ä¢ Use serverless functions to talk to Printful API

</Notes>

---

<Layout>

  # Demo

  https://graphcms-printful-example.now.sh

</Layout>

---

<Layout>

  <Split>
    <img src={me2} style={{ width: '50%' }}/>
    Thanks for listening!
  </Split>

</Layout>

